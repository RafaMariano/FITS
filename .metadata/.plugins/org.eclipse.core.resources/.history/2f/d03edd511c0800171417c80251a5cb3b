package br.inpe.filesystem;

import java.io.IOException;
import java.nio.file.Files;
import java.nio.file.Path;
import java.nio.file.Paths;
import java.text.ParseException;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;
import java.util.regex.Matcher;
import java.util.regex.Pattern;
import java.util.stream.Stream;

import org.springframework.context.ApplicationContext;
import org.springframework.context.support.ClassPathXmlApplicationContext;

import br.inpe.model.Image;
import br.inpe.model.ImagesCollection;
import br.inpe.service.ImageServiceImpl;
import nom.tam.fits.FitsException;

public class Main {
	
	public static void main(String[] args) throws IOException, ParseException, FitsException {
//		
//		try{
//				
//			ApplicationContext ctx = new ClassPathXmlApplicationContext("applicationContext.xml");
//			Controller controller = (Controller) ctx.getBean("controller");
//			
//			ArrayList<String> imagesPathList = controller.getImages();
//			
//			ImageServiceImpl imagesService = (ImageServiceImpl) ctx.getBean("imageService");
//
//			for (String pathImage: imagesPathList){
//				
//				String newPath = controller.getNewPath(pathImage);
//				Image image = new Image(newPath);
//				ImagesCollection ima = new ImagesCollection();
//				ima.setDocument(image.getDocument());
//				imagesService.saveImage(ima);
//				
//			}	
//		}
//		catch(IOException io){
//			
//		}

		List<String> lines = Files.readAllLines(Paths.get("/home/inpe/a.txt"));
		
		Map<String,String> a2 = new HashMap<>();
	
		lines.add("print('foobar');");
		Files.write(Paths.get("/home/inpe/a.txt"), lines);
		
		for(String a: lines){
			
			if (a.contains("="))
				a2.put(a.substring(0, a.indexOf("=")-1), a.substring(a.indexOf("=")+2));
			else
				a2.put(a, "");
		}
		
		
		//System.out.println(a2.get("PATH_ORIGINAL"));
//		try (Stream<String> stream = Files.lines(Paths.get("/home/inpe/a.txt"))) {
//		    stream
//		        .filter(line -> line.contains("PATH_ORIGINAL"))
//		        .map(String::trim)
//		        .forEach(System.out::println);
//		}
	}

}
