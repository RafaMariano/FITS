package br.inpe.database;

import java.io.IOException;
import java.util.List;

import org.bson.Document;
import org.codehaus.jackson.JsonGenerationException;
import org.codehaus.jackson.JsonParseException;
import org.codehaus.jackson.map.JsonMappingException;
import org.codehaus.jackson.map.ObjectMapper;
import org.json.JSONArray;
import org.json.JSONObject;

import com.mongodb.client.FindIterable;
import com.mongodb.client.MongoCollection;
import com.mongodb.client.MongoCursor;
import com.mongodb.client.model.Filters;


public class Query {
	private static ObjectMapper mapper = new ObjectMapper();
	
	public static Object findOne(int value) throws JsonGenerationException, JsonMappingException, JsonParseException, IOException {

		JSONObject b = new JSONObject();
		
		
		FindIterable<Document> findI = Mongo.getInstance().getDataBase().getCollection("inpe").find()
				.projection(new Document("_id", 1)).limit(10).skip(value);
		
		for (Document doc: findI)
			b.append("_id", doc.get("_id"));
			
		return b.toString();

	}
	
	
	public static String findOne(String key) throws JsonGenerationException, JsonMappingException, JsonParseException, IOException{
		MongoCollection<Document> collection = Mongo.getInstance().getDataBase().getCollection("inpe");
		
		return getMapper().writerWithDefaultPrettyPrinter().
				writeValueAsString(getMapper().readValue(collection.find().filter(Filters.eq("_id",key)).first().toJson(), Object.class));
		//return collection.find().filter(Filters.eq("_id",key)).first().toJson();
		
	}


	public static ObjectMapper getMapper() {
		return mapper;
	}


		
		//name/ssw_cutout_20110706_025754_AIA_1600_.fts
		//ssw_cutout_20110706_025754_AIA_1600_.fts
	

}
