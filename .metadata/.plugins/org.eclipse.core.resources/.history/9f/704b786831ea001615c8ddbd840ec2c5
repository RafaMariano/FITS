package br.inpe.database;

import java.io.IOException;

import org.bson.Document;
import org.codehaus.jackson.JsonGenerationException;
import org.codehaus.jackson.map.JsonMappingException;
import org.codehaus.jackson.map.ObjectMapper;
import org.json.JSONArray;

import com.mongodb.client.MongoCollection;
import com.mongodb.client.MongoCursor;
import com.mongodb.client.model.Filters;

public class Query {
	private static int a = 0;
	
	
//	
//	public static void findOne(String key, String value){
//		MongoCollection<Document> collection = Mongo.getInstance().getDataBase().getCollection("inpe");
//		Document findI = collection.find().filter(Filters.eq(key,value)).first();
//		System.out.println(findI);
//	}
//	
	public static String findOne(int page) throws JsonGenerationException, JsonMappingException, IOException{
		MongoCollection<Document> collection = Mongo.getInstance().getDataBase().getCollection("inpe");
		ObjectMapper mapper = new ObjectMapper();
		
JSONArray a = new JSONArray();
		
		try (MongoCursor<Document> co = collection.find().projection(new Document("_id",1)).limit(10).skip(0).iterator()) {
		 //http://stackoverflow.com/questions/25589113/how-to-select-a-single-field-in-mongodb
		
			while (collection.hasNext()) {
				//ss.append(collection.next());
		      
				a.put(collection.next().toJson());
		      
		    }
		}
		
		System.out.println(a.toList());
	}
		
		Object json = mapper.readValue(collection.find().limit(10).skip(page).first().toJson(), Object.class);
		return mapper.writerWithDefaultPrettyPrinter().writeValueAsString(json);
				//collection.find().filter(Filters.eq(key,value)).first();
	}
	
}
